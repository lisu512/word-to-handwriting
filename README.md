# 手写作业生成器 📝

一个高质量的文本转手写图片工具，能够将普通文本转换为逼真的手写作业效果。

## ✨ 主要特性

### 🎨 真实手写效果
- **多字体混合**：支持5种真实手写字体随机切换
- **字符级变化**：每个字符独立选择字体，避免单调重复
- **智能基线对齐**：不同字体自动调整基线，确保整齐美观
- **自然随机偏移**：轻微的位置和大小变化，模拟真实手写

### 📄 智能排版
- **自动换行**：智能控制每行29-30字符，支持标点符号优化断行
- **段落处理**：自动识别段落结构，首行缩进，段落间距
- **多页支持**：长文本自动分页，每页约25行
- **红线背景**：生成标准作业本红线背景

### 🔧 技术优势
- **按字符渲染**：精确控制每个字符的字体、大小、位置
- **基线校准**：针对不同字体进行精确基线调整
- **格式保持**：完整保留原文段落结构和格式

## 🛠️ 安装要求

### 系统依赖
```bash
pip install python-docx opencv-python pillow
```

### 字体文件
将手写字体文件（.ttf格式）放置在 `font/` 目录下，支持的字体：
- MengMeiZiTi-1.ttf
- 千图纤墨体.ttf  
- 李国夫手写体.ttf
- pigtruman手写体.ttf
- 白路俏丽手写体.ttf

## 🚀 使用方法

### 基本用法
```bash
# 从文本文件生成手写图片
python improved_homework_creator.py input.txt

# 直接输入文本内容
python improved_homework_creator.py --text "你的文本内容"

# 指定输出目录
python improved_homework_creator.py input.txt -o output_folder
```

### 输入格式
支持纯文本文件，建议使用UTF-8编码：
```
一、第一题标题

这是第一段内容。这里会自动换行和段落处理。

这是第二段内容，段落间会有适当间距。

二、第二题标题

继续你的文本内容...
```

### 输出结果
- 生成的图片保存在 `res/` 目录
- 文件格式：`result_1.jpg`, `result_2.jpg` 等
- 图片尺寸：A4标准尺寸 (1998×2585像素)

## 📊 核心算法

### 字体选择策略
- **主字体**：李国夫手写体（60%使用率）
- **点缀字体**：其他4种字体随机切换（40%使用率）
- **字符级切换**：每个字符独立选择字体

### 基线对齐算法
```python
font_y_offsets = {
    "MengMeiZiTi-1": 0,      # 基准字体
    "千图纤墨体": -8,         # 向上调整8像素
    "李国夫手写体": 0,        # 基准字体  
    "pigtruman手写体": 2,     # 向下调整2像素
    "白路俏丽手写体": 1,      # 向下调整1像素
}
```

### 换行优化
- 每行严格控制在29-30字符
- 优先在标点符号后断开
- 保持段落首行缩进

## 📁 项目结构

```
word-to-handwriting/
├── improved_homework_creator.py    # 主程序
├── font/                          # 字体文件目录
│   ├── MengMeiZiTi-1.ttf
│   ├── 千图纤墨体.ttf
│   ├── 李国夫手写体.ttf
│   ├── pigtruman手写体.ttf
│   └── 白路俏丽手写体.ttf
├── res/                           # 输出图片目录
├── temporary/                     # 临时文件目录
└── README.md                      # 项目说明
```

## 🎯 效果展示

### 主要特点
1. **字体多样性**：同一行文字使用多种字体混合
2. **自然对齐**：所有字符完美对齐红线基准
3. **真实间距**：字符间距自然变化，避免机械感
4. **完整格式**：保持原文段落结构和缩进

### 质量保证
- ✅ 字符基线完美对齐
- ✅ 段落结构完整保留  
- ✅ 自动换行整齐美观
- ✅ 多字体自然混合
- ✅ 红线背景标准规范

## ⚙️ 高级配置

### 字体切换频率
修改 `improved_homework_creator.py` 中的参数：
```python
if random.random() < 0.80:  # 调整其他字体使用频率
```

### 随机偏移范围
```python
x_random = random.randint(-1, 1)  # 水平偏移范围
y_random = random.randint(-1, 1)  # 垂直偏移范围
```

### 字体大小变化
```python
size_variation = random.randint(-2, 2)  # 字体大小变化范围
font_size = 60 + size_variation         # 基础字体大小
```

## 🔍 故障排除

### 常见问题
1. **字体文件缺失**：确保所有字体文件在 `font/` 目录下
2. **依赖包缺失**：使用 `pip install` 安装所需依赖
3. **编码问题**：确保文本文件使用UTF-8编码
4. **权限问题**：确保有写入输出目录的权限

### 性能优化
- 长文本建议分段处理
- 大量生成时可考虑并行处理
- 定期清理 `temporary/` 目录

## 📝 更新日志

### v1.0 特性
- ✅ 多字体混合渲染
- ✅ 智能换行算法
- ✅ 基线对齐优化
- ✅ 红线背景生成
- ✅ 段落格式保持
- ✅ 字符级字体切换

## 🤝 贡献指南

欢迎提交问题反馈和改进建议！

## 📄 许可证

本项目仅供学习交流使用。

---

**⚠️ 使用声明**：本工具仅用于学习和测试目的，请勿用于任何不当用途。 